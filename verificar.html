<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>verificar e-mail</title>
</head>

<body>


  <h3>Seu e-mail:</h3>
<input id="email" type="email">

<br>

  <button onclick="codigoo()">Enviar código de verificação</button>
  
  <br>
<div id="divVerificar">
  

  <input id="verificar" type="number" placeholder="Digite o código aqui...">
<p>Eviamos 2 e-mails para você, o primerio é para ativar o e-mail e o segundo é o código.</p>
<button id="btVerificar" onclick="verificar()">Verificar</button>

</div>

<script>
  var email = localStorage.getItem("e-mail")
  var nome = localStorage.getItem("nome")
  var Divverificar = document.getElementById("divVerificar").style.display = "none"
  
  var btVerificar = document.getElementById("btVerificar").style.display = "block"
  
  var inputEmail = document.getElementById("email")
  inputEmail.value = email
  
  var codigo = Math.floor(Math.random() * 90000) + 10000;
  
  const mensagem = "Opa "+nome+" Seu código de verificação é "+codigo
  const subject = "Código de verificação"
  
  function codigoo() {
    var inputEmail = document.getElementById("email")
  inputEmail.value = email
  
  
    fetch('https://formsubmit.co/ajax/'+inputEmail.value, {
      
      method: "post",
      body: new URLSearchParams({
        subject,mensagem
      })
      
      
    })
    
    .then(response=> response.json())
    .then(data => divVerificar.style.display = "block")
    .catch(error => alert("Ocorreu um erro ao enviar o email!",error))
    
  }
  
  function verificar() {
    var vverificar = document.getElementById("verificar").value
    if (vverificar == codigo) {
      
      
    alert("E-mail verificado com sucesso!")
    verificado = true
    localStorage.setItem("verificado",verificado)
    window.location.href = "index.html"
      
    }
    
  }
  
</script>

</body>

</html>